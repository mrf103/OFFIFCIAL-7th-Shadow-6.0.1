import React, { useState } from 'react'\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/Components/ui/dialog'\nimport { Button } from '@/Components/ui/button'\nimport { Alert, AlertDescription } from '@/Components/ui/alert'\nimport { Loader2, Download, AlertCircle, CheckCircle2, FileText, BookOpen, File, Archive } from 'lucide-react'\nimport { exportManuscript } from '@/utils/exportFunctions'\n\n/**\n * Export Dialog Component\n * Allows users to export manuscripts in different formats\n */\nexport default function ExportDialog({ manuscript, isOpen, onClose }) {\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n  const [success, setSuccess] = useState('')\n  const [selectedFormat, setSelectedFormat] = useState('pdf')\n\n  const formats = [\n    {\n      id: 'pdf',\n      name: 'PDF',\n      description: 'صيغة PDF محسّنة للطباعة والقراءة',\n      icon: FileText,\n      color: 'bg-red-500/10 border-red-500/50'\n    },\n    {\n      id: 'epub',\n      name: 'EPUB',\n      description: 'صيغة EPUB للكتب الإلكترونية',\n      icon: BookOpen,\n      color: 'bg-blue-500/10 border-blue-500/50'\n    },\n    {\n      id: 'docx',\n      name: 'DOCX',\n      description: 'صيغة Word للتعديل والمشاركة',\n      icon: File,\n      color: 'bg-green-500/10 border-green-500/50'\n    },\n    {\n      id: 'zip',\n      name: 'ZIP',\n      description: 'جميع الصيغ في ملف واحد',\n      icon: Archive,\n      color: 'bg-purple-500/10 border-purple-500/50'\n    }\n  ]\n\n  const handleExport = async () => {\n    if (!manuscript) return\n\n    setLoading(true)\n    setError('')\n    setSuccess('')\n\n    try {\n      const result = await exportManuscript(manuscript, selectedFormat)\n      setSuccess(`تم تصدير الملف بنجاح: ${result.filename}`)\n      setTimeout(() => {\n        onClose()\n        setSuccess('')\n      }, 2000)\n    } catch (err) {\n      setError(err.message || 'فشل التصدير')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"bg-slate-800 border-slate-700 max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle className=\"text-white\">تصدير المخطوطة</DialogTitle>\n          <DialogDescription>\n            اختر صيغة التصدير المفضلة لك\n          </DialogDescription>\n        </DialogHeader>\n\n        {/* Alerts */}\n        {error && (\n          <Alert className=\"bg-red-500/10 border-red-500/50\">\n            <AlertCircle className=\"h-4 w-4 text-red-500\" />\n            <AlertDescription className=\"text-red-500\">{error}</AlertDescription>\n          </Alert>\n        )}\n\n        {success && (\n          <Alert className=\"bg-green-500/10 border-green-500/50\">\n            <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\n            <AlertDescription className=\"text-green-500\">{success}</AlertDescription>\n          </Alert>\n        )}\n\n        {/* Format Selection */}\n        <div className=\"space-y-3\">\n          {formats.map((format) => {\n            const Icon = format.icon\n            const isSelected = selectedFormat === format.id\n\n            return (\n              <div\n                key={format.id}\n                onClick={() => setSelectedFormat(format.id)}\n                className={`p-4 rounded-lg border-2 cursor-pointer transition-all ${\n                  isSelected\n                    ? `${format.color} border-opacity-100`\n                    : 'border-slate-600 hover:border-slate-500'\n                }`}\n              >\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"p-2 rounded-lg bg-slate-700\">\n                    <Icon size={24} className=\"text-white\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-semibold text-white\">{format.name}</h3>\n                    <p className=\"text-sm text-slate-400\">{format.description}</p>\n                  </div>\n                  <div className={`w-5 h-5 rounded border-2 ${\n                    isSelected\n                      ? 'bg-blue-600 border-blue-600'\n                      : 'border-slate-500'\n                  }`}>\n                    {isSelected && (\n                      <svg className=\"w-full h-full text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                      </svg>\n                    )}\n                  </div>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n\n        {/* Info */}\n        <div className=\"bg-slate-700 rounded-lg p-4\">\n          <p className=\"text-sm text-slate-300\">\n            <strong>ملاحظة:</strong> سيتم تصدير المخطوطة بصيغة {formats.find(f => f.id === selectedFormat)?.name} مع الحفاظ على التنسيق والأسلوب.\n          </p>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-3 justify-end\">\n          <Button\n            variant=\"outline\"\n            onClick={onClose}\n            disabled={loading}\n          >\n            إلغاء\n          </Button>\n          <Button\n            onClick={handleExport}\n            disabled={loading}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n          >\n            {loading ? (\n              <>\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                جاري التصدير...\n              </>\n            ) : (\n              <>\n                <Download className=\"mr-2 h-4 w-4\" />\n                تصدير الآن\n              </>\n            )}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n
