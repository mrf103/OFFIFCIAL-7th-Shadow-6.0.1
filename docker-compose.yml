version: '3.8'\n\nservices:\n  # Main application\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    container_name: shadow-seven-app\n    ports:\n      - \"${PORT:-3000}:3000\"\n    environment:\n      - NODE_ENV=${NODE_ENV:-production}\n      - PORT=3000\n      - VITE_SUPABASE_URL=${VITE_SUPABASE_URL}\n      - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY}\n      - VITE_GOOGLE_AI_API_KEY=${VITE_GOOGLE_AI_API_KEY}\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD\", \"node\", \"-e\", \"require('http').get('http://localhost:3000/health', (r) => {if (r.statusCode !== 200) throw new Error(r.statusCode)})\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 5s\n    networks:\n      - shadow-seven-network\n    volumes:\n      - ./logs:/app/logs\n    labels:\n      - \"com.shadow-seven.description=Shadow Seven Publishing Platform\"\n      - \"com.shadow-seven.version=4.0.0\"\n\n  # Nginx reverse proxy\n  nginx:\n    image: nginx:alpine\n    container_name: shadow-seven-nginx\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./ssl:/etc/nginx/ssl:ro\n      - ./logs/nginx:/var/log/nginx\n    depends_on:\n      - app\n    restart: unless-stopped\n    networks:\n      - shadow-seven-network\n\nnetworks:\n  shadow-seven-network:\n    driver: bridge\n\nvolumes:\n  logs:\n    driver: local\n
